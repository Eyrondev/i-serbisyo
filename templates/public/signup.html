<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Sign Up - i-Serbisyo Barangay Management System">
    <meta name="robots" content="noindex, nofollow">
    
    <title>Sign Up - i-Serbisyo</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='images/iserbisyo_icon.png') }}">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', '-apple-system', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-in-out',
                        'slide-up': 'slideUp 0.6s ease-out',
                        'slide-in-right': 'slideInRight 0.4s ease-out',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        slideInRight: {
                            '0%': { transform: 'translateX(20px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        }
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>
    
    <!-- Alpine.js for interactive components -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body class="min-h-screen bg-cover bg-center bg-no-repeat bg-fixed" style="background-image: url('../../static/images/login_bg.png');">
    
    <!-- Loading Screen -->
    {% include 'components/loading-screen.html' %}
    
    <!-- Background Pattern -->
    <div class="fixed inset-0 z-0">
        <div class="absolute inset-0 bg-black/30"></div>
        <div class="absolute top-0 left-0 w-full h-full opacity-30">
            <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <pattern id="grid" width="32" height="32" patternUnits="userSpaceOnUse">
                        <path d="m 0 0 l 0 32 l 32 0" stroke="#3b82f6" stroke-width="0.5" fill="none" opacity="0.1"/>
                    </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#grid)"/>
            </svg>
        </div>
    </div>

    <!-- Main Content -->
    <div class="relative z-10 min-h-screen flex items-center py-4 sm:py-6 lg:py-8 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto w-full">
            <!-- Multi-step Form -->
            <div x-data="signupForm()" class="bg-white rounded-xl sm:rounded-2xl shadow-xl border border-gray-200 overflow-hidden">
                <!-- Header inside form -->
                <div class="text-center pt-6 sm:pt-8 pb-3 sm:pb-4 px-4 sm:px-6 lg:px-8">
                    <img class="mx-auto h-12 sm:h-14 lg:h-16 w-auto mb-3 sm:mb-4" src="{{ url_for('static', filename='images/iserbisyo_icon.png') }}" alt="i-Serbisyo Logo">
                    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-1 sm:mb-2">Create Your Account</h1>
                    <p class="text-sm sm:text-base lg:text-lg text-gray-600">Join the i-Serbisyo community and access digital barangay services</p>
                </div>
                <!-- Progress Indicator -->
                <div class="bg-gray-50 px-3 sm:px-4 lg:px-6 py-3 sm:py-4 border-b border-gray-200">
                    <!-- Mobile Progress (dots only) -->
                    <div class="flex md:hidden items-center justify-center space-x-3">
                        <div class="flex items-center justify-center w-8 h-8 rounded-full text-xs font-medium transition-colors duration-200"
                             :class="currentStep >= 1 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                            <span x-show="currentStep > 1">✓</span>
                            <span x-show="currentStep <= 1">1</span>
                        </div>
                        <div class="flex items-center justify-center w-8 h-8 rounded-full text-xs font-medium transition-colors duration-200"
                             :class="currentStep >= 2 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                            <span x-show="currentStep > 2">✓</span>
                            <span x-show="currentStep <= 2">2</span>
                        </div>
                        <div class="flex items-center justify-center w-8 h-8 rounded-full text-xs font-medium transition-colors duration-200"
                             :class="currentStep >= 3 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                            <span x-show="currentStep > 3">✓</span>
                            <span x-show="currentStep <= 3">3</span>
                        </div>
                        <div class="flex items-center justify-center w-8 h-8 rounded-full text-xs font-medium transition-colors duration-200"
                             :class="currentStep >= 4 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                            <span x-show="currentStep > 4">✓</span>
                            <span x-show="currentStep <= 4">4</span>
                        </div>
                    </div>
                    
                    <!-- Tablet/Desktop Progress -->
                    <div class="hidden md:flex items-center justify-between">
                        <div class="flex items-center space-x-4 lg:space-x-8">
                            <!-- Step 1 -->
                            <div class="flex items-center">
                                <div class="flex items-center justify-center w-8 h-8 lg:w-10 lg:h-10 rounded-full text-xs lg:text-sm font-medium transition-colors duration-200"
                                     :class="currentStep >= 1 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                                    <span x-show="currentStep > 1">✓</span>
                                    <span x-show="currentStep <= 1">1</span>
                                </div>
                                <span class="ml-2 lg:ml-3 text-xs lg:text-sm font-medium hidden lg:inline" :class="currentStep >= 1 ? 'text-primary-600' : 'text-gray-500'">Personal Info</span>
                                <span class="ml-2 text-xs font-medium lg:hidden" :class="currentStep >= 1 ? 'text-primary-600' : 'text-gray-500'">Personal</span>
                            </div>
                            
                            <!-- Step 2 -->
                            <div class="flex items-center">
                                <div class="flex items-center justify-center w-8 h-8 lg:w-10 lg:h-10 rounded-full text-xs lg:text-sm font-medium transition-colors duration-200"
                                     :class="currentStep >= 2 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                                    <span x-show="currentStep > 2">✓</span>
                                    <span x-show="currentStep <= 2">2</span>
                                </div>
                                <span class="ml-2 lg:ml-3 text-xs lg:text-sm font-medium hidden lg:inline" :class="currentStep >= 2 ? 'text-primary-600' : 'text-gray-500'">Address & Contact</span>
                                <span class="ml-2 text-xs font-medium lg:hidden" :class="currentStep >= 2 ? 'text-primary-600' : 'text-gray-500'">Address</span>
                            </div>
                            
                            <!-- Step 3 -->
                            <div class="flex items-center">
                                <div class="flex items-center justify-center w-8 h-8 lg:w-10 lg:h-10 rounded-full text-xs lg:text-sm font-medium transition-colors duration-200"
                                     :class="currentStep >= 3 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                                    <span x-show="currentStep > 3">✓</span>
                                    <span x-show="currentStep <= 3">3</span>
                                </div>
                                <span class="ml-2 lg:ml-3 text-xs lg:text-sm font-medium" :class="currentStep >= 3 ? 'text-primary-600' : 'text-gray-500'">Documents</span>
                            </div>
                            
                            <!-- Step 4 -->
                            <div class="flex items-center">
                                <div class="flex items-center justify-center w-8 h-8 lg:w-10 lg:h-10 rounded-full text-xs lg:text-sm font-medium transition-colors duration-200"
                                     :class="currentStep >= 4 ? 'bg-primary-600 text-white' : 'bg-gray-200 text-gray-500'">
                                    <span x-show="currentStep > 4">✓</span>
                                    <span x-show="currentStep <= 4">4</span>
                                </div>
                                <span class="ml-2 lg:ml-3 text-xs lg:text-sm font-medium" :class="currentStep >= 4 ? 'text-primary-600' : 'text-gray-500'">Account</span>
                            </div>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="hidden lg:block w-48 xl:w-64">
                            <div class="bg-gray-200 rounded-full h-2">
                                <div class="bg-primary-600 h-2 rounded-full transition-all duration-500" 
                                     :style="`width: ${((currentStep - 1) / 3) * 100}%`"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <form @submit.prevent="handleSubmit" method="POST" enctype="multipart/form-data" class="p-4 sm:p-6 lg:p-8">
                    <!-- Step 1: Personal Information -->
                    <div x-show="currentStep === 1" x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0 transform translate-x-6"
                         x-transition:enter-end="opacity-100 transform translate-x-0">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">Personal Information</h2>
                        
                        <!-- Profile Picture Upload -->
                        <div class="mb-6 sm:mb-8">
                            <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-3 sm:mb-4">Profile Picture</label>
                            <div class="flex flex-col sm:flex-row items-center sm:space-x-6 space-y-4 sm:space-y-0">
                                <div class="relative">
                                    <div class="w-20 h-20 sm:w-24 sm:h-24 rounded-full overflow-hidden bg-gray-200 flex items-center justify-center border-2 border-dashed border-gray-300">
                                        <img x-show="profilePreview" :src="profilePreview" class="w-full h-full object-cover">
                                        <div x-show="!profilePreview" class="text-center">
                                            <svg class="w-6 h-6 sm:w-8 sm:h-8 text-gray-400 mx-auto mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                            </svg>
                                            <span class="text-xs text-gray-500">Photo</span>
                                        </div>
                                    </div>
                                    <button type="button" @click="$refs.profileInput.click()" 
                                            class="absolute -bottom-2 -right-2 bg-primary-600 text-white rounded-full p-1.5 sm:p-2 hover:bg-primary-700 transition-colors duration-200">
                                        <svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="text-center sm:text-left">
                                    <button type="button" @click="$refs.profileInput.click()" 
                                            class="bg-white border border-gray-300 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors duration-200">
                                        Choose Photo
                                    </button>
                                    <p class="text-xs text-gray-500 mt-1">JPG, PNG up to 5MB</p>
                                </div>
                                <input type="file" name="profilePicture" x-ref="profileInput" @change="handleProfileUpload" accept="image/*" class="hidden">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                            <!-- First Name -->
                            <div>
                                <label for="firstName" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">First Name *</label>
                                <input type="text" id="firstName" name="firstName" x-model="form.firstName" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.firstName" x-text="errors.firstName" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Middle Name -->
                            <div>
                                <label for="middleName" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Middle Name</label>
                                <input type="text" id="middleName" name="middleName" x-model="form.middleName"
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                            </div>

                            <!-- Last Name -->
                            <div>
                                <label for="lastName" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Last Name *</label>
                                <input type="text" id="lastName" name="lastName" x-model="form.lastName" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.lastName" x-text="errors.lastName" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Suffix -->
                            <div>
                                <label for="suffix" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Suffix</label>
                                <select id="suffix" name="suffix" x-model="form.suffix"
                                        class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                    <option value="">Select Suffix</option>
                                    <option value="Jr.">Jr.</option>
                                    <option value="Sr.">Sr.</option>
                                    <option value="II">II</option>
                                    <option value="III">III</option>
                                    <option value="IV">IV</option>
                                </select>
                            </div>

                            <!-- Birth Date -->
                            <div>
                                <label for="birthDate" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Birth Date *</label>
                                <input type="date" id="birthDate" name="birthDate" x-model="form.birthDate" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.birthDate" x-text="errors.birthDate" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Birth Place -->
                            <div>
                                <label for="birthPlace" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Birth Place *</label>
                                <input type="text" id="birthPlace" name="birthPlace" x-model="form.birthPlace" required placeholder="City, Province"
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.birthPlace" x-text="errors.birthPlace" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Gender -->
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Gender *</label>
                                <div class="flex space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="gender" x-model="form.gender" value="Male" class="text-primary-600 focus:ring-primary-500">
                                        <span class="ml-2 text-xs sm:text-sm text-gray-700">Male</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="gender" x-model="form.gender" value="Female" class="text-primary-600 focus:ring-primary-500">
                                        <span class="ml-2 text-xs sm:text-sm text-gray-700">Female</span>
                                    </label>
                                </div>
                                <p x-show="errors.gender" x-text="errors.gender" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Civil Status -->
                            <div>
                                <label for="civilStatus" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Civil Status *</label>
                                <select id="civilStatus" name="civilStatus" x-model="form.civilStatus" required
                                        class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                    <option value="">Select Civil Status</option>
                                    <option value="Single">Single</option>
                                    <option value="Married">Married</option>
                                    <option value="Divorced">Divorced</option>
                                    <option value="Widowed">Widowed</option>
                                </select>
                                <p x-show="errors.civilStatus" x-text="errors.civilStatus" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Address & Contact -->
                    <div x-show="currentStep === 2" x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0 transform translate-x-6"
                         x-transition:enter-end="opacity-100 transform translate-x-0">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">Address & Contact Information</h2>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                            <!-- House Number -->
                            <div>
                                <label for="houseNumber" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">House Number *</label>
                                <input type="text" id="houseNumber" name="houseNumber" x-model="form.houseNumber" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.houseNumber" x-text="errors.houseNumber" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Street -->
                            <div>
                                <label for="street" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Street *</label>
                                <input type="text" id="street" name="street" x-model="form.street" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.street" x-text="errors.street" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Purok -->
                            <div>
                                <label for="purok" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Purok/Sitio *</label>
                                <select id="purok" name="purok" x-model="form.purok" required
                                        class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                    <option value="" x-show="puroks.length === 0">Loading puroks...</option>
                                    <option value="" x-show="puroks.length > 0">Select Purok/Sitio</option>
                                    <template x-for="purok in puroks" :key="purok.id">
                                        <option :value="purok.name" x-text="`${purok.name} (${purok.type})`"></option>
                                    </template>
                                </select>
                                <p x-show="errors.purok" x-text="errors.purok" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Email -->
                            <div>
                                <label for="email" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Email Address *</label>
                                <input type="email" id="email" name="email" x-model="form.email" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.email" x-text="errors.email" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Phone -->
                            <div>
                                <label for="phone" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Phone Number *</label>
                                <input type="tel" id="phone" name="phone" x-model="form.phone" required placeholder="09XX-XXX-XXXX"
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p x-show="errors.phone" x-text="errors.phone" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Occupation -->
                            <div>
                                <label for="occupation" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Occupation</label>
                                <input type="text" id="occupation" name="occupation" x-model="form.occupation"
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                            </div>

                            <!-- Voter Status -->
                            <div class="flex items-center space-x-4">
                                <label class="flex items-center">
                                    <input type="checkbox" name="isVoter" x-model="form.isVoter" class="text-primary-600 focus:ring-primary-500">
                                    <span class="ml-2 text-xs sm:text-sm text-gray-700">I am a registered voter in this barangay</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Document Verification -->
                    <div x-show="currentStep === 3" x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0 transform translate-x-6"
                         x-transition:enter-end="opacity-100 transform translate-x-0">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-3 sm:mb-4">Document Verification</h2>
                        <p class="text-xs sm:text-sm lg:text-base text-gray-600 mb-6 sm:mb-8">Please upload clear photos or scans of the required documents for verification.</p>
                        
                        <div class="space-y-6 sm:space-y-8">
                            <!-- Valid ID -->
                            <div class="border border-gray-200 rounded-lg p-4 sm:p-6">
                                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-2 sm:mb-4">Valid Government ID *</h3>
                                <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">Upload a clear photo of any government-issued ID (Driver's License, SSS, UMID, Passport, etc.)</p>
                                
                                <div class="flex flex-col lg:flex-row lg:items-center lg:space-x-6 space-y-4 lg:space-y-0">
                                    <div class="flex-1">
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 sm:p-6 text-center hover:border-primary-400 transition-colors duration-200"
                                             :class="{'border-primary-400 bg-primary-50': documents.validId}"
                                             @click="$refs.validIdInput.click()"
                                             @dragover.prevent @drop.prevent="handleDrop($event, 'validId')">
                                            <div x-show="!documents.validId">
                                                <svg class="mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                                </svg>
                                                <p class="mt-2 text-xs sm:text-sm text-gray-600">Drop your ID here, or <span class="text-primary-600 font-medium">click to browse</span></p>
                                                <p class="text-xs text-gray-500">PNG, JPG up to 10MB</p>
                                            </div>
                                            <div x-show="documents.validId" class="flex items-center justify-center space-x-3">
                                                <svg class="h-5 w-5 sm:h-6 sm:w-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"/>
                                                </svg>
                                                <span class="text-xs sm:text-sm font-medium text-gray-900 truncate max-w-[150px] sm:max-w-none" x-text="documents.validId?.name"></span>
                                                <button type="button" @click.stop="removeDocument('validId')" class="text-red-500 hover:text-red-700">
                                                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                        <input type="file" name="validId" x-ref="validIdInput" @change="handleDocumentUpload($event, 'validId')" accept=".png" class="hidden">
                                    </div>
                                </div>
                                <p x-show="errors.validId" x-text="errors.validId" class="mt-2 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Proof of Residency -->
                            <div class="border border-gray-200 rounded-lg p-4 sm:p-6">
                                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-2 sm:mb-4">Proof of Residency *</h3>
                                <p class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4">Upload a document showing your current address (Barangay Certificate, Utility Bill, Lease Contract, etc.)</p>
                                
                                <div class="flex flex-col lg:flex-row lg:items-center lg:space-x-6 space-y-4 lg:space-y-0">
                                    <div class="flex-1">
                                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 sm:p-6 text-center hover:border-primary-400 transition-colors duration-200"
                                             :class="{'border-primary-400 bg-primary-50': documents.proofOfResidency}"
                                             @click="$refs.proofInput.click()"
                                             @dragover.prevent @drop.prevent="handleDrop($event, 'proofOfResidency')">
                                            <div x-show="!documents.proofOfResidency">
                                                <svg class="mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                                </svg>
                                                <p class="mt-2 text-xs sm:text-sm text-gray-600">Drop your document here, or <span class="text-primary-600 font-medium">click to browse</span></p>
                                                <p class="text-xs text-gray-500">PNG, JPG, PDF up to 10MB</p>
                                            </div>
                                            <div x-show="documents.proofOfResidency" class="flex items-center justify-center space-x-3">
                                                <svg class="h-5 w-5 sm:h-6 sm:w-6 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"/>
                                                </svg>
                                                <span class="text-xs sm:text-sm font-medium text-gray-900 truncate max-w-[150px] sm:max-w-none" x-text="documents.proofOfResidency?.name"></span>
                                                <button type="button" @click.stop="removeDocument('proofOfResidency')" class="text-red-500 hover:text-red-700">
                                                    <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                                    </svg>
                                                </button>
                                            </div>
                                        </div>
                                        <input type="file" name="proofOfResidency" x-ref="proofInput" @change="handleDocumentUpload($event, 'proofOfResidency')" accept=".png" class="hidden">
                                    </div>
                                </div>
                                <p x-show="errors.proofOfResidency" x-text="errors.proofOfResidency" class="mt-2 text-xs sm:text-sm text-red-600"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Account Setup -->
                    <div x-show="currentStep === 4" x-transition:enter="transition ease-out duration-300"
                         x-transition:enter-start="opacity-0 transform translate-x-6"
                         x-transition:enter-end="opacity-100 transform translate-x-0">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-4 sm:mb-6">Account Setup</h2>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                            <!-- Username -->
                            <div class="sm:col-span-2">
                                <label for="username" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Username *</label>
                                <input type="text" id="username" name="username" x-model="form.username" required
                                       class="w-full px-3 sm:px-4 py-2 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                <p class="text-xs text-gray-500 mt-1">Username must be 4-20 characters long and contain only letters, numbers, and underscores</p>
                                <p x-show="errors.username" x-text="errors.username" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Password -->
                            <div>
                                <label for="password" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Password *</label>
                                <div class="relative">
                                    <input :type="showPassword ? 'text' : 'password'" id="password" name="password" x-model="form.password" required
                                           class="w-full px-3 sm:px-4 py-2 sm:py-3 pr-10 sm:pr-12 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                    <button type="button" @click="showPassword = !showPassword" 
                                            class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                                        <svg x-show="!showPassword" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                        </svg>
                                        <svg x-show="showPassword" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L5.636 5.636m4.242 4.242L12 14.121M21 21l-9-9"/>
                                        </svg>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">Password must be at least 8 characters long</p>
                                <p x-show="errors.password" x-text="errors.password" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>

                            <!-- Confirm Password -->
                            <div>
                                <label for="confirmPassword" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Confirm Password *</label>
                                <div class="relative">
                                    <input :type="showConfirmPassword ? 'text' : 'password'" id="confirmPassword" name="confirmPassword" x-model="form.confirmPassword" required
                                           class="w-full px-3 sm:px-4 py-2 sm:py-3 pr-10 sm:pr-12 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors duration-200">
                                    <button type="button" @click="showConfirmPassword = !showConfirmPassword" 
                                            class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                                        <svg x-show="!showConfirmPassword" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                        </svg>
                                        <svg x-show="showConfirmPassword" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L5.636 5.636m4.242 4.242L12 14.121M21 21l-9-9"/>
                                        </svg>
                                    </button>
                                </div>
                                <p x-show="errors.confirmPassword" x-text="errors.confirmPassword" class="mt-1 text-xs sm:text-sm text-red-600"></p>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="mt-6 sm:mt-8">
                            <div class="bg-gray-50 rounded-lg p-4 sm:p-6">
                                <div class="flex items-start space-x-3">
                                    <input type="checkbox" id="terms" name="agreeToTerms" x-model="form.agreeToTerms" required
                                           class="mt-1 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                                    <div>
                                        <label for="terms" class="text-xs sm:text-sm text-gray-700">
                                            I agree to the <a href="#" class="text-primary-600 hover:text-primary-500 font-medium">Terms of Service</a> 
                                            and <a href="#" class="text-primary-600 hover:text-primary-500 font-medium">Privacy Policy</a>. 
                                            I understand that my personal information will be used for account verification and barangay services.
                                        </label>
                                    </div>
                                </div>
                                <p x-show="errors.agreeToTerms" x-text="errors.agreeToTerms" class="mt-2 text-xs sm:text-sm text-red-600"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="flex flex-col sm:flex-row sm:justify-between mt-6 sm:mt-8 pt-4 sm:pt-6 border-t border-gray-200 gap-3 sm:gap-0">
                        <button type="button" x-show="currentStep > 1" @click="previousStep()" 
                                class="flex items-center justify-center px-4 sm:px-6 py-2 sm:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 text-sm sm:text-base order-2 sm:order-1">
                            <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                            </svg>
                            Previous
                        </button>
                        
                        <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 order-1 sm:order-2">
                            <a x-show="currentStep === 1" href="{{ url_for('auth.login') }}" 
                               class="flex items-center justify-center px-4 sm:px-6 py-2 sm:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors duration-200 text-sm sm:text-base">
                                <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14"/>
                                </svg>
                                <span class="hidden sm:inline">Back to Login</span>
                                <span class="sm:hidden">Login</span>
                            </a>
                            <button type="button" x-show="currentStep < 4" @click="nextStep()" 
                                    :disabled="!canProceed()"
                                    :class="canProceed() ? 'bg-primary-600 hover:bg-primary-700 text-white' : 'bg-gray-300 text-gray-500 cursor-not-allowed'"
                                    class="flex items-center justify-center px-4 sm:px-6 py-2 sm:py-3 rounded-lg font-medium transition-colors duration-200 text-sm sm:text-base">
                                Next
                                <svg class="w-4 h-4 sm:w-5 sm:h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                                </svg>
                            </button>
                            
                            <button type="submit" x-show="currentStep === 4" 
                                    :disabled="loading || !canSubmit()"
                                    :class="(loading || !canSubmit()) ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white'"
                                    class="flex items-center justify-center px-6 sm:px-8 py-2 sm:py-3 rounded-lg font-medium transition-colors duration-200 text-sm sm:text-base">
                                <span x-show="!loading" class="flex items-center">
                                    <svg class="w-4 h-4 sm:w-5 sm:h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                                    </svg>
                                    <span class="hidden sm:inline">Create Account</span>
                                    <span class="sm:hidden">Create</span>
                                </span>
                                <span x-show="loading" class="flex items-center">
                                    <svg class="animate-spin -ml-1 mr-2 sm:mr-3 h-4 w-4 sm:h-5 sm:w-5 text-white" fill="none" viewBox="0 0 24 24">
                                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                    </svg>
                                    <span class="hidden sm:inline">Creating Account...</span>
                                    <span class="sm:hidden">Creating...</span>
                                </span>
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Alert Messages -->
                <div x-show="alert.show" x-transition class="mx-4 sm:mx-6 lg:mx-8 mb-6 sm:mb-8 rounded-lg p-3 sm:p-4" 
                     :class="alert.type === 'error' ? 'bg-red-50 text-red-700 border border-red-200' : 'bg-green-50 text-green-700 border border-green-200'">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg x-show="alert.type === 'error'" class="h-4 w-4 sm:h-5 sm:w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                            </svg>
                            <svg x-show="alert.type === 'success'" class="h-4 w-4 sm:h-5 sm:w-5 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <p class="text-xs sm:text-sm font-medium" x-text="alert.message"></p>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>

    <!-- JavaScript -->
    <script>
        function signupForm() {
            return {
                currentStep: 1,
                loading: false,
                showPassword: false,
                showConfirmPassword: false,
                profilePreview: null,
                puroks: [], // List of puroks from database
                form: {
                    // Step 1
                    firstName: '',
                    middleName: '',
                    lastName: '',
                    suffix: '',
                    birthDate: '',
                    birthPlace: '',
                    gender: '',
                    civilStatus: '',
                    // Step 2
                    houseNumber: '',
                    street: '',
                    purok: '',
                    email: '',
                    phone: '',
                    occupation: '',
                    isVoter: false,
                    // Step 4
                    username: '',
                    password: '',
                    confirmPassword: '',
                    agreeToTerms: false
                },
                documents: {
                    validId: null,
                    proofOfResidency: null,
                    profilePicture: null
                },
                errors: {},
                alert: {
                    show: false,
                    type: 'error',
                    message: ''
                },

                // Initialize component
                init() {
                    this.loadPuroks();
                },

                // Load puroks from API
                async loadPuroks() {
                    try {
                        const response = await fetch('/api/puroks');
                        const data = await response.json();
                        if (data.success) {
                            this.puroks = data.puroks;
                        } else {
                            console.error('Failed to load puroks:', data.message);
                        }
                    } catch (error) {
                        console.error('Error loading puroks:', error);
                    }
                },

                nextStep() {
                    if (this.validateCurrentStep()) {
                        this.currentStep++;
                    }
                },

                previousStep() {
                    this.currentStep--;
                    this.errors = {};
                },

                canProceed() {
                    return this.validateCurrentStep(false);
                },

                canSubmit() {
                    return this.form.agreeToTerms && 
                           this.form.username && 
                           this.form.password && 
                           this.form.confirmPassword &&
                           this.form.password === this.form.confirmPassword;
                },

                validateCurrentStep(showErrors = true) {
                    this.errors = {};
                    let isValid = true;

                    if (this.currentStep === 1) {
                        if (!this.form.firstName.trim()) {
                            if (showErrors) this.errors.firstName = 'First name is required';
                            isValid = false;
                        }
                        if (!this.form.lastName.trim()) {
                            if (showErrors) this.errors.lastName = 'Last name is required';
                            isValid = false;
                        }
                        if (!this.form.birthDate) {
                            if (showErrors) this.errors.birthDate = 'Birth date is required';
                            isValid = false;
                        }
                        if (!this.form.birthPlace.trim()) {
                            if (showErrors) this.errors.birthPlace = 'Birth place is required';
                            isValid = false;
                        }
                        if (!this.form.gender) {
                            if (showErrors) this.errors.gender = 'Gender is required';
                            isValid = false;
                        }
                        if (!this.form.civilStatus) {
                            if (showErrors) this.errors.civilStatus = 'Civil status is required';
                            isValid = false;
                        }
                    } else if (this.currentStep === 2) {
                        if (!this.form.houseNumber.trim()) {
                            if (showErrors) this.errors.houseNumber = 'House number is required';
                            isValid = false;
                        }
                        if (!this.form.street.trim()) {
                            if (showErrors) this.errors.street = 'Street is required';
                            isValid = false;
                        }
                        if (!this.form.purok) {
                            if (showErrors) this.errors.purok = 'Purok is required';
                            isValid = false;
                        }
                        if (!this.form.email.trim()) {
                            if (showErrors) this.errors.email = 'Email is required';
                            isValid = false;
                        } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email)) {
                            if (showErrors) this.errors.email = 'Please enter a valid email';
                            isValid = false;
                        }
                        if (!this.form.phone.trim()) {
                            if (showErrors) this.errors.phone = 'Phone number is required';
                            isValid = false;
                        }
                    } else if (this.currentStep === 3) {
                        if (!this.documents.validId) {
                            if (showErrors) this.errors.validId = 'Valid ID is required';
                            isValid = false;
                        }
                        if (!this.documents.proofOfResidency) {
                            if (showErrors) this.errors.proofOfResidency = 'Proof of residency is required';
                            isValid = false;
                        }
                    }

                    return isValid;
                },

                handleProfileUpload(event) {
                    const file = event.target.files[0];
                    if (file) {
                        if (file.size > 5 * 1024 * 1024) {
                            this.showAlert('error', 'Profile picture must be less than 5MB');
                            return;
                        }
                        
                        this.documents.profilePicture = file;
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.profilePreview = e.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                },

                handleDocumentUpload(event, type) {
                    const file = event.target.files[0];
                    if (file) {
                        if (file.size > 10 * 1024 * 1024) {
                            this.showAlert('error', 'Document must be less than 10MB');
                            return;
                        }
                        this.documents[type] = file;
                        this.errors[type] = '';
                    }
                },

                handleDrop(event, type) {
                    const file = event.dataTransfer.files[0];
                    if (file) {
                        if (file.size > 10 * 1024 * 1024) {
                            this.showAlert('error', 'Document must be less than 10MB');
                            return;
                        }
                        this.documents[type] = file;
                        this.errors[type] = '';
                    }
                },

                removeDocument(type) {
                    this.documents[type] = null;
                    if (type === 'profilePicture') {
                        this.profilePreview = null;
                    }
                },

                async handleSubmit() {
                    if (!this.validateCurrentStep()) return;
                    if (!this.canSubmit()) return;

                    this.loading = true;
                    this.hideAlert();

                    try {
                        // Create FormData object
                        const formData = new FormData();
                        
                        // Add all form fields
                        Object.keys(this.form).forEach(key => {
                            if (key !== 'agreeToTerms' && this.form[key] !== null && this.form[key] !== '') {
                                formData.append(key, this.form[key]);
                            }
                        });
                        
                        // Add checkbox value
                        if (this.form.agreeToTerms) {
                            formData.append('agreeToTerms', 'on');
                        }
                        
                        // Add file uploads
                        if (this.documents.profilePicture) {
                            formData.append('profilePicture', this.documents.profilePicture);
                        }
                        if (this.documents.validId) {
                            formData.append('validId', this.documents.validId);
                        }
                        if (this.documents.proofOfResidency) {
                            formData.append('proofOfResidency', this.documents.proofOfResidency);
                        }

                        // Submit form
                        const response = await fetch('{{ url_for("public.signup") }}', {
                            method: 'POST',
                            body: formData
                        });

                        const result = await response.json();

                        if (result.success) {
                            this.loading = false;
                            this.showAlert('success', result.message);
                            
                            setTimeout(() => {
                                window.location.href = result.redirect_url;
                            }, 2000);
                        } else {
                            this.loading = false;
                            // Handle validation errors
                            if (result.errors) {
                                this.errors = result.errors;
                                if (result.errors.general) {
                                    this.showAlert('error', result.errors.general);
                                }
                            }
                        }
                    } catch (error) {
                        this.loading = false;
                        this.showAlert('error', 'An error occurred. Please try again.');
                        console.error('Signup error:', error);
                    }
                },

                showAlert(type, message) {
                    this.alert = {
                        show: true,
                        type: type,
                        message: message
                    };
                },

                hideAlert() {
                    this.alert.show = false;
                }
            }
        }
    </script>
    
    <!-- Main JavaScript -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>